
	ORG $900
	
PITADR	 SET	   $10000
PITTCR   SET       $21   ;TIMER CONTROL REGISTER
PITVEC   SET       $23   ;TIMER INTR VEC
PITCHI   SET       $27   ;TIMER COUNT HIGH 
PITCMI	 SET	   $29   ;TIMER COUNT MID
PITCLO   SET       $2B   ;TIMER COUNT LOW

VEC		 SET	   $40

VECADDR	 EQU	   VEC * 4


ITEST	LEA		STACK(PC),A7
		CLR.L	ICOUNT
		MOVEA.L	#$10000,A0
		CLR.B	$21(A0)
		MOVE.L	#$80,D0
		MOVE.B	D0,$23(A0)
		ASL.L	#2,D0
		MOVE.L	D0,A1
		LEA		INTR(PC),A2
		MOVE.L	A2,(A1)
		MOVE.L	#$01ffff,D1
		MOVEP.L	D1,$25(A0)
		MOVE.W	SR,D0
		AND.W	#$f800,D0
		OR.W	#$0100,D0
		MOVE.W	D0,SR
		MOVE.B	#$b7,$21(A0)
		
ITEST1	CMP.W	#20,ICOUNT
		BNE		ITEST1
		
		CLR.B	$21(A0)
		OR.W	#$0700,SR
		TRAP    #1
		
INTR	MOVE.W	D0,-(A7)
		MOVE.W	ICOUNT,D0
		ADDQ.W	#1,D0
		MOVE.W	D0,ICOUNT
		MOVE.W	(A7)+,D0
		RTE
		
ICOUNT	DS 2
		DS 64
STACK	DS 0